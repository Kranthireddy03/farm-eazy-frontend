import{i as q,r as c,h as d,k as o,j as e,T as G}from"./index-D_IIqowu.js";function W(){const{toast:h,showToast:n,closeToast:D}=q(),[v,C]=c.useState([]),[E,y]=c.useState(!0),[m,x]=c.useState(!1),[b,l]=c.useState(""),[j,N]=c.useState(!1),[w,p]=c.useState(null),[f,S]=c.useState([]),[a,i]=c.useState({cropName:"",season:"",sowingDate:"",expectedHarvestDate:"",farmId:"",status:"PLANTED"});c.useEffect(()=>{u(),H()},[]);const u=async()=>{try{y(!0);const s=await d.get(o.GET_CROPS);C(s.data),l("")}catch(s){l("Failed to load crops"),console.error(s),n("Failed to load crops","error")}finally{y(!1)}},H=async()=>{try{const s=await d.get(o.GET_FARMS);S(s.data)}catch(s){console.error("Failed to fetch farms:",s)}},t=s=>{const{name:r,value:g}=s.target;i(L=>({...L,[r]:g}))},A=async s=>{if(s.preventDefault(),!a.cropName||!a.season||!a.sowingDate||!a.expectedHarvestDate||!a.farmId){l("Please fill in all required fields"),n("Please fill in all required fields","warning");return}x(!0);try{await d.post(o.CREATE_CROP,{cropName:a.cropName,season:a.season,sowingDate:a.sowingDate,expectedHarvestDate:a.expectedHarvestDate,farmId:parseInt(a.farmId),status:a.status}),i({cropName:"",season:"",sowingDate:"",expectedHarvestDate:"",farmId:"",status:"PLANTED"}),N(!1),l(""),n("Crop created successfully!","success"),await u()}catch(r){l(r.message||"Failed to create crop"),n(r.message||"Failed to create crop","error")}finally{x(!1)}},I=async s=>{if(window.confirm("Are you sure you want to delete this crop?"))try{await d.delete(o.DELETE_CROP(s)),l(""),n("Crop deleted successfully!","success"),await u()}catch{l("Failed to delete crop"),n("Failed to delete crop","error")}},T=s=>{p(s),i({cropName:s.cropName,season:s.season,sowingDate:s.sowingDate,expectedHarvestDate:s.expectedHarvestDate,farmId:s.farmId,status:s.status}),N(!1)},P=async s=>{if(s.preventDefault(),!a.cropName||!a.season||!a.sowingDate||!a.expectedHarvestDate||!a.farmId){l("Please fill in all required fields"),n("Please fill in all required fields","warning");return}x(!0);try{await d.put(o.UPDATE_CROP(w.id),{cropName:a.cropName,season:a.season,sowingDate:a.sowingDate,expectedHarvestDate:a.expectedHarvestDate,farmId:parseInt(a.farmId),status:a.status}),i({cropName:"",season:"",sowingDate:"",expectedHarvestDate:"",farmId:"",status:"PLANTED"}),p(null),l(""),n("Crop updated successfully!","success"),await u()}catch(r){l(r.message||"Failed to update crop"),n(r.message||"Failed to update crop","error")}finally{x(!1)}},F=()=>{p(null),i({cropName:"",season:"",sowingDate:"",expectedHarvestDate:"",farmId:"",status:"PLANTED"})},R=s=>{const r=f.find(g=>g.id===s);return r?r.farmName:"Unknown Farm"},k=s=>({PLANTED:"bg-blue-100 text-blue-800",GROWING:"bg-green-100 text-green-800",READY:"bg-yellow-100 text-yellow-800",HARVESTED:"bg-gray-100 text-gray-800"})[s]||"bg-gray-100 text-gray-800";return E?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"spinner text-green-600 mb-4",children:e.jsx("svg",{className:"w-12 h-12",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2z"})})}),e.jsx("p",{className:"text-gray-600",children:"Loading crops..."})]})}):e.jsxs(e.Fragment,{children:[h&&e.jsx(G,{message:h.message,type:h.type,onClose:D}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-800",children:"Crops"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Track all your crops and their status"})]}),e.jsx("button",{onClick:()=>{N(!j),p(null),i({cropName:"",season:"",sowingDate:"",expectedHarvestDate:"",farmId:"",status:"PLANTED"})},className:"btn-primary",children:j?"Cancel":"+ Add Crop"})]}),b&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:b}),j&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Add New Crop"}),e.jsxs("form",{onSubmit:A,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Crop Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"cropName",value:a.cropName,onChange:t,className:"form-input",placeholder:"e.g., Wheat",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Farm ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"farmId",value:a.farmId,onChange:t,className:"form-input",required:!0,children:[e.jsx("option",{value:"",children:"-- Select a farm --"}),f.map(s=>e.jsx("option",{value:s.id,children:s.farmName},s.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Season ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"season",value:a.season,onChange:t,className:"form-input",placeholder:"e.g., Rabi",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{name:"status",value:a.status,onChange:t,className:"form-input",children:[e.jsx("option",{value:"PLANTED",children:"Planted"}),e.jsx("option",{value:"GROWING",children:"Growing"}),e.jsx("option",{value:"READY",children:"Ready"}),e.jsx("option",{value:"HARVESTED",children:"Harvested"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Sowing Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"sowingDate",value:a.sowingDate,onChange:t,className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Expected Harvest Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"expectedHarvestDate",value:a.expectedHarvestDate,onChange:t,className:"form-input",required:!0})]})]}),e.jsx("button",{type:"submit",disabled:m,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Crop"})]})]}),w&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-800 mb-4",children:"Edit Crop"}),e.jsxs("form",{onSubmit:P,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Crop Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"cropName",value:a.cropName,onChange:t,className:"form-input",placeholder:"e.g., Wheat",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Farm ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"farmId",value:a.farmId,onChange:t,className:"form-input",required:!0,children:[e.jsx("option",{value:"",children:"-- Select a farm --"}),f.map(s=>e.jsx("option",{value:s.id,children:s.farmName},s.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Season ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"season",value:a.season,onChange:t,className:"form-input",placeholder:"e.g., Rabi",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Status"}),e.jsxs("select",{name:"status",value:a.status,onChange:t,className:"form-input",children:[e.jsx("option",{value:"PLANTED",children:"Planted"}),e.jsx("option",{value:"GROWING",children:"Growing"}),e.jsx("option",{value:"READY",children:"Ready"}),e.jsx("option",{value:"HARVESTED",children:"Harvested"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Sowing Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"sowingDate",value:a.sowingDate,onChange:t,className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Expected Harvest Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"expectedHarvestDate",value:a.expectedHarvestDate,onChange:t,className:"form-input",required:!0})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"submit",disabled:m,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Updating..."]}):"Update Crop"}),e.jsx("button",{type:"button",onClick:F,className:"btn-secondary",children:"Cancel"})]})]})]}),v.length===0?e.jsx("div",{className:"card text-center py-12",children:e.jsx("p",{className:"text-gray-600 text-lg",children:"No crops yet. Add your first crop!"})}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:v.map(s=>e.jsxs("div",{className:"card hover:shadow-lg transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-gray-800",children:s.cropName}),e.jsxs("p",{className:"text-gray-600 text-sm",children:["ðŸ“ ",R(s.farmId)]})]}),e.jsx("span",{className:"text-2xl",children:"ðŸŒ±"})]}),e.jsxs("div",{className:"space-y-2 mb-4 pb-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Season"}),e.jsx("p",{className:"font-semibold text-gray-800",children:s.season})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Status"}),e.jsx("span",{className:`px-3 py-1 rounded-full text-sm font-medium ${k(s.status)}`,children:s.status})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Sowing Date"}),e.jsx("p",{className:"font-semibold text-gray-800",children:new Date(s.sowingDate).toLocaleDateString()})]}),e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-gray-600 text-sm",children:"Expected Harvest"}),e.jsx("p",{className:"font-semibold text-gray-800",children:new Date(s.expectedHarvestDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{onClick:()=>T(s),className:"flex-1 btn-primary text-center text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>I(s.id),className:"flex-1 btn-secondary text-sm",children:"Delete"})]})]},s.id))})]})]})}export{W as default};
//# sourceMappingURL=Crops-CEKLY_b7.js.map
