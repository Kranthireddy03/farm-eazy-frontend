import{i as F,r as n,j as e,u as A,h as R}from"./index-BSllqeVN.js";function M({product:s,isOpen:x,onClose:o,onAddToCart:N}){const{showToast:c}=F(),[a,m]=n.useState(1),[g,d]=n.useState(!1);if(n.useEffect(()=>{x&&m(1)},[x]),!x||!s)return null;const v=async()=>{if(a<=0){c("Please select a valid quantity","warning");return}if(a>s.quantity){c(`Only ${s.quantity} items available in stock`,"warning");return}try{d(!0);const r={id:s.id,productName:s.productName,description:s.description,price:s.price,discountPercentage:s.discountPercentage,discountedPrice:s.discountedPrice,category:s.category,categoryIcon:h(s.category),sellerId:s.userId,sellerFullName:s.sellerFullName,availableQuantity:s.quantity,quantity:a,addedAt:new Date().toISOString()};N(r),c(`Added ${a} item(s) to cart! ðŸ›’`,"success"),setTimeout(()=>{o()},500)}catch(r){c("Failed to add product to cart","error"),console.error("Error:",r)}finally{d(!1)}},h=r=>({SEEDS:"ðŸŒ±",FERTILIZERS:"ðŸ§ª",PESTICIDES:"ðŸ¦Ÿ",TOOLS:"ðŸ”§",EQUIPMENT:"ðŸšœ",ORGANIC:"ðŸŒ¿",PRODUCE:"ðŸ¥•",MACHINERY:"ðŸšœ",IRRIGATION:"ðŸ’§",OTHERS:"ðŸ“¦"})[r?.toUpperCase()]||"ðŸ“¦",b=s.quantity<=0,y=s.quantity/(s.quantity+10)*100;return e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg shadow-2xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-gradient-to-r from-orange-500 to-orange-600 p-6 flex justify-between items-center",children:[e.jsx("div",{className:"text-4xl",children:h(s.category)}),e.jsx("button",{onClick:o,className:"text-white text-3xl hover:opacity-80 transition",children:"âœ•"})]}),e.jsxs("div",{className:"p-8",children:[e.jsx("h2",{className:"text-3xl font-bold text-white mb-2",children:s.productName}),e.jsxs("div",{className:"flex items-center gap-3 mb-6 pb-6 border-b border-slate-700",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ‘¨â€ðŸŒ¾"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Seller"}),e.jsx("p",{className:"font-semibold text-white",children:s.sellerFullName})]})]}),e.jsxs("div",{className:"bg-orange-900/40 rounded-lg p-4 mb-6",children:[e.jsx("p",{className:"text-slate-300 text-sm mb-1",children:"Price per unit"}),s.discountPercentage&&s.discountPercentage>0?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center gap-3 mb-1",children:[e.jsxs("p",{className:"text-4xl font-bold text-orange-600",children:["â‚¹",s.discountedPrice?s.discountedPrice.toFixed(2):(s.price-s.price*s.discountPercentage/100).toFixed(2)]}),e.jsxs("span",{className:"line-through text-gray-400 text-xl",children:["â‚¹",s.price.toFixed(2)]})]}),e.jsxs("span",{className:"bg-green-500 text-white text-sm font-bold px-3 py-1 rounded",children:["ðŸ·ï¸ ",s.discountPercentage,"% OFF"]})]}):e.jsxs("p",{className:"text-4xl font-bold text-orange-600",children:["â‚¹",s.price.toFixed(2)]})]}),s.description&&e.jsxs("div",{className:"mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-white mb-2",children:"About this product"}),e.jsx("p",{className:"text-slate-300 leading-relaxed",children:s.description})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("p",{className:"text-sm text-slate-400 mb-1",children:"Category"}),e.jsx("div",{className:"inline-block bg-orange-900/50 text-orange-400 px-4 py-2 rounded-full font-semibold",children:s.category})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-300",children:"Stock Status"}),e.jsx("p",{className:`font-bold ${s.quantity>0?"text-green-400":"text-red-400"}`,children:s.quantity>0?`${s.quantity} in stock`:"Out of Stock"})]}),e.jsx("div",{className:"w-full bg-slate-700 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${s.quantity>5?"bg-green-500":"bg-yellow-500"}`,style:{width:`${Math.min(y,100)}%`}})})]}),!b&&e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{className:"text-lg font-semibold text-white mb-3 block",children:"How many would you like?"}),e.jsxs("div",{className:"flex items-center gap-4 bg-slate-700 rounded-lg w-fit p-2",children:[e.jsx("button",{onClick:()=>m(Math.max(1,a-1)),className:"bg-slate-600 hover:bg-slate-500 text-white font-bold text-xl px-4 py-2 rounded transition",children:"âˆ’"}),e.jsx("input",{type:"number",value:a,onChange:r=>{const f=parseInt(r.target.value)||1;m(Math.min(Math.max(1,f),s.quantity))},className:"w-20 text-center text-xl font-bold bg-transparent text-white border-none outline-none",min:"1",max:s.quantity}),e.jsx("button",{onClick:()=>m(Math.min(s.quantity,a+1)),className:"bg-slate-600 hover:bg-slate-500 text-white font-bold text-xl px-4 py-2 rounded transition",children:"+"})]}),e.jsxs("p",{className:"text-sm text-slate-400 mt-2",children:["Max available: ",s.quantity," units"]})]}),e.jsxs("div",{className:"bg-gradient-to-r from-orange-900/40 to-amber-900/40 rounded-lg p-4 mb-8 border-2 border-orange-800",children:[e.jsxs("p",{className:"text-slate-300 mb-1",children:["Total for ",a," item(s):"]}),s.discountPercentage&&s.discountPercentage>0?e.jsxs("div",{children:[e.jsxs("p",{className:"text-3xl font-bold text-orange-600",children:["â‚¹",((s.discountedPrice||s.price-s.price*s.discountPercentage/100)*a).toFixed(2)]}),e.jsxs("p",{className:"text-sm text-green-600 font-semibold mt-1",children:["You save â‚¹",((s.price-(s.discountedPrice||s.price-s.price*s.discountPercentage/100))*a).toFixed(2)]})]}):e.jsxs("p",{className:"text-3xl font-bold text-orange-600",children:["â‚¹",(s.price*a).toFixed(2)]})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{onClick:o,className:"flex-1 bg-gray-200 hover:bg-gray-300 text-gray-800 font-bold py-3 px-6 rounded-lg transition text-lg",children:"Cancel"}),e.jsx("button",{onClick:v,disabled:b||g,className:"flex-1 bg-gradient-to-r from-orange-500 to-orange-600 hover:from-orange-600 hover:to-orange-700 disabled:opacity-50 disabled:cursor-not-allowed text-white font-bold py-3 px-6 rounded-lg transition text-lg flex items-center justify-center gap-2",children:g?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin",children:"â³"})," Adding..."]}):e.jsx(e.Fragment,{children:"ðŸ›’ Add to Cart"})})]}),b&&e.jsx("p",{className:"text-center text-red-600 font-semibold mt-4",children:"âš ï¸ This product is currently out of stock"})]})]})})}function D(){const s=A(),{showToast:x}=F(),[o,N]=n.useState([]),[c,a]=n.useState([]),[m,g]=n.useState(!0),[d,v]=n.useState(""),[h,b]=n.useState("ALL"),[y,r]=n.useState(null),[f,w]=n.useState(!1),[j,k]=n.useState({}),P=[{value:"ALL",label:"All Products",icon:"ðŸ›’"},{value:"SEEDS",label:"Seeds",icon:"ðŸŒ±"},{value:"FERTILIZERS",label:"Fertilizers",icon:"ðŸ§ª"},{value:"PESTICIDES",label:"Pesticides",icon:"ðŸ¦Ÿ"},{value:"TOOLS",label:"Tools",icon:"ðŸ”§"},{value:"EQUIPMENT",label:"Equipment",icon:"ðŸšœ"},{value:"ORGANIC",label:"Organic",icon:"ðŸŒ¿"},{value:"OTHERS",label:"Others",icon:"ðŸ“¦"}];n.useEffect(()=>{I()},[]),n.useEffect(()=>{T()},[o,d,h]);const I=async()=>{try{g(!0);const t=await R.get("/products");N(t.data)}catch(t){x("Failed to load products","error"),console.error("Error fetching products:",t)}finally{g(!1)}},T=()=>{let t=o;h!=="ALL"&&(t=t.filter(l=>l.category===h)),d&&(t=t.filter(l=>l.productName.toLowerCase().includes(d.toLowerCase())||l.description.toLowerCase().includes(d.toLowerCase())||l.sellerFullName.toLowerCase().includes(d.toLowerCase()))),a(t)},C=t=>{const l=P.find(i=>i.value===t);return l?l.icon:"ðŸ“¦"},q=t=>{const l=JSON.parse(localStorage.getItem("farmeazy_cart")||"[]"),i=l.findIndex(u=>u.id===t.id);if(i>-1){const u=t.availableQuantity,E=l[i].quantity+t.quantity;E>u?(x(`Cannot add more than ${u} items of this product`,"warning"),l[i].quantity=u):l[i].quantity=E}else l.push(t);localStorage.setItem("farmeazy_cart",JSON.stringify(l)),window.dispatchEvent(new Event("cart-updated"))},L=t=>{r(t),w(!0)},O=()=>{w(!1),r(null)},S=(t,l)=>{k(i=>({...i,[t]:{...i[t],[l]:!0}}))},p=(t,l=!1)=>{const i=`/product/${t}`;if(l){window.open(i,"_blank","noopener,noreferrer");return}s(i)};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 py-8 px-4",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("div",{className:"text-5xl mb-3",children:"ðŸ›’"}),e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Buying Center"}),e.jsx("p",{className:"text-lg text-slate-400",children:"Browse quality agricultural products from verified sellers"})]}),e.jsxs("div",{className:"bg-slate-800 rounded-lg shadow-lg p-6 mb-8 border border-slate-700",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:d,onChange:t=>v(t.target.value),placeholder:"Search products, sellers...",className:"w-full pl-10 pr-4 py-3 bg-slate-700 border border-slate-600 text-white placeholder-slate-400 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent"}),e.jsx("span",{className:"absolute left-3 top-3.5 text-slate-400",children:"ðŸ”"})]})}),e.jsx("div",{className:"md:w-64",children:e.jsx("select",{value:h,onChange:t=>b(t.target.value),className:"w-full px-4 py-3 bg-slate-700 border border-slate-600 text-white rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:P.map(t=>e.jsxs("option",{value:t.value,children:[t.icon," ",t.label]},t.value))})})]}),e.jsxs("div",{className:"mt-4 text-sm text-slate-400",children:["Showing ",c.length," of ",o.length," products"]})]}),m&&e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-orange-500"}),e.jsx("p",{className:"mt-4 text-slate-400",children:"Loading products..."})]}),!m&&c.length===0&&e.jsxs("div",{className:"bg-slate-800 rounded-lg shadow-lg p-12 text-center border border-slate-700",children:[e.jsx("div",{className:"text-6xl mb-4",children:"ðŸ“¦"}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-2",children:"No Products Found"}),e.jsx("p",{className:"text-slate-400 mb-6",children:o.length===0?"No products are available yet. Be the first to list a product!":"Try adjusting your search or filters"}),o.length===0&&e.jsx("button",{onClick:()=>s("/selling"),className:"px-6 py-3 bg-orange-500 text-white rounded-lg font-semibold hover:bg-orange-600 transition-colors",children:"List a Product"})]}),!m&&c.length>0&&e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:c.map(t=>e.jsxs("div",{className:"bg-slate-800 rounded-lg shadow-lg overflow-hidden hover:shadow-xl transition-shadow border border-slate-700",children:[e.jsxs("div",{className:"relative h-48 bg-gradient-to-br from-slate-700 to-slate-600 cursor-pointer",onClick:()=>p(t.id),children:[t.imageUrl?e.jsx("img",{src:t.imageUrl,alt:t.productName,className:"w-full h-full object-cover",onError:l=>{l.target.style.display="none"}}):e.jsx("div",{className:"flex items-center justify-center h-full text-6xl",children:C(t.category)}),e.jsxs("div",{className:"absolute top-3 right-3 bg-slate-900/80 text-white px-3 py-1 rounded-full text-sm font-semibold",children:[C(t.category)," ",t.category]}),t.discountPercentage&&t.discountPercentage>0&&e.jsxs("div",{className:"absolute top-3 left-3 bg-gradient-to-r from-green-500 to-green-600 text-white px-3 py-1.5 rounded-lg text-sm font-bold shadow-lg",children:["ðŸ·ï¸ ",t.discountPercentage,"% OFF"]})]}),e.jsxs("div",{className:"p-5",children:[e.jsx("button",{onClick:()=>p(t.id),className:"text-left",children:e.jsx("h3",{className:"text-xl font-bold text-white mb-2 hover:text-orange-400 transition",children:t.productName})}),e.jsx("p",{className:"text-slate-400 text-sm mb-3 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-2 mb-3 text-sm text-slate-400",children:[e.jsx("span",{children:"ðŸ‘¤"}),e.jsx("span",{children:t.sellerFullName})]}),e.jsxs("div",{className:"flex items-center gap-2 mb-3 text-sm text-slate-400",children:[e.jsx("span",{children:"ðŸ“"}),e.jsx("span",{children:t.sellerLocation||"Location not specified"})]}),e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Available"}),e.jsxs("p",{className:"font-semibold text-white",children:[t.quantity," ",t.unit]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm text-slate-400",children:"Price"}),t.discountPercentage&&t.discountPercentage>0?e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-end gap-2 mb-1",children:[e.jsxs("span",{className:"line-through text-slate-500 text-sm",children:["â‚¹",t.price]}),e.jsxs("span",{className:"bg-green-600 text-white text-xs font-bold px-2 py-0.5 rounded",children:[t.discountPercentage,"% OFF"]})]}),e.jsxs("p",{className:"text-2xl font-bold text-orange-400",children:["â‚¹",t.discountedPrice||(t.price-t.price*t.discountPercentage/100).toFixed(2),e.jsxs("span",{className:"text-sm text-slate-400",children:["/",t.unit]})]})]}):e.jsxs("p",{className:"text-2xl font-bold text-orange-400",children:["â‚¹",t.price,e.jsxs("span",{className:"text-sm text-slate-400",children:["/",t.unit]})]})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:l=>{l.stopPropagation(),L(t)},className:"flex-1 px-4 py-2 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg font-semibold hover:from-orange-600 hover:to-orange-700 transition-all flex items-center justify-center gap-2",children:"ðŸ›’ Add to Cart"}),e.jsx("button",{onClick:l=>{if(l.stopPropagation(),!t.sellerPhone){x("Seller phone not available","warning");return}S(t.id,"phone")},disabled:!t.sellerPhone,className:`px-4 py-2 rounded-lg font-semibold transition-colors ${t.sellerPhone?"bg-green-600 text-white hover:bg-green-700":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:"ðŸ“ž"}),e.jsx("button",{onClick:l=>{if(l.stopPropagation(),!t.sellerEmail){x("Seller email not available","warning");return}S(t.id,"email")},disabled:!t.sellerEmail,className:`px-4 py-2 rounded-lg font-semibold transition-colors ${t.sellerEmail?"bg-blue-600 text-white hover:bg-blue-700":"bg-gray-200 text-gray-400 cursor-not-allowed"}`,children:"âœ‰ï¸"})]}),(j[t.id]?.phone||j[t.id]?.email)&&e.jsxs("div",{className:"mt-3 text-xs text-slate-300 space-y-1",children:[j[t.id]?.phone&&t.sellerPhone&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-green-400",children:"ðŸ“ž"}),e.jsx("a",{href:`tel:${t.sellerPhone}`,className:"text-green-400 font-semibold hover:underline",children:t.sellerPhone})]}),j[t.id]?.email&&t.sellerEmail&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-400",children:"âœ‰ï¸"}),e.jsx("a",{href:`mailto:${t.sellerEmail}`,className:"text-blue-400 font-semibold hover:underline",children:t.sellerEmail})]})]}),e.jsx("button",{onClick:()=>p(t.id,!0),className:"mt-3 w-full px-4 py-2 bg-slate-700 border border-slate-600 text-orange-400 rounded-lg font-semibold hover:bg-slate-600 transition",children:"View Details"})]})]},t.id))}),e.jsx(M,{product:y,isOpen:f,onClose:O,onAddToCart:q})]})]})})}export{D as default};
//# sourceMappingURL=Buying-Be64puuQ.js.map
