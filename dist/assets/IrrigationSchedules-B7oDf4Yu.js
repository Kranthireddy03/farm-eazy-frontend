import{r as l,h as d,k as c,j as e}from"./index-D_IIqowu.js";function O(){const f=window,u=()=>{f.fetchStats&&f.fetchStats()},[N,I]=l.useState([]),[g,S]=l.useState([]),[b,C]=l.useState([]),[D,v]=l.useState(!0),[o,m]=l.useState(!1),[w,r]=l.useState(""),[p,j]=l.useState(!1),[y,x]=l.useState(null),[a,i]=l.useState({cropId:"",farmId:"",irrigationDate:"",startTime:"06:00",duration:"",waterAmount:"",notes:""});l.useEffect(()=>{h(),A(),T()},[]);const h=async()=>{try{v(!0);const s=await d.get(c.GET_IRRIGATION_SCHEDULES);I(s.data),r("")}catch(s){r("Failed to load irrigation schedules"),console.error(s)}finally{v(!1)}},A=async()=>{try{const s=await d.get(c.GET_CROPS);S(s.data)}catch(s){console.error("Failed to fetch crops:",s)}},T=async()=>{try{const s=await d.get(c.GET_FARMS);C(s.data)}catch(s){console.error("Failed to fetch farms:",s)}},t=s=>{const{name:n,value:_}=s.target;i(G=>({...G,[n]:_}))},E=async s=>{if(s.preventDefault(),!a.cropId||!a.farmId||!a.irrigationDate||!a.startTime||!a.duration||!a.waterAmount){r("Please fill in all required fields");return}m(!0);try{await d.post(c.CREATE_IRRIGATION,{cropId:parseInt(a.cropId),farmId:parseInt(a.farmId),irrigationDate:a.irrigationDate,startTime:a.startTime,duration:parseInt(a.duration),waterAmount:parseFloat(a.waterAmount),notes:a.notes}),i({cropId:"",farmId:"",irrigationDate:"",startTime:"06:00",duration:"",waterAmount:"",notes:""}),j(!1),r(""),await h(),u()}catch(n){r(n.message||"Failed to create schedule")}finally{m(!1)}},F=async s=>{if(window.confirm("Are you sure you want to delete this schedule?"))try{await d.delete(c.DELETE_IRRIGATION(s)),r(""),await h(),u()}catch{r("Failed to delete schedule")}},k=s=>{x(s),i({cropId:s.cropId||"",farmId:s.farmId||"",irrigationDate:s.scheduleDate||s.irrigationDate||"",startTime:s.startTime||"06:00",duration:s.duration||"",waterAmount:s.waterAmount||"",notes:s.notes||""}),j(!1)},q=async s=>{if(s.preventDefault(),!a.cropId||!a.farmId||!a.irrigationDate||!a.startTime||!a.duration||!a.waterAmount){r("Please fill in all required fields");return}m(!0);try{await d.put(c.UPDATE_IRRIGATION(y.id),{cropId:parseInt(a.cropId),farmId:parseInt(a.farmId),irrigationDate:a.irrigationDate,startTime:a.startTime,duration:parseInt(a.duration),waterAmount:parseFloat(a.waterAmount),notes:a.notes}),i({cropId:"",farmId:"",irrigationDate:"",startTime:"06:00",duration:"",waterAmount:"",notes:""}),x(null),r(""),await h(),u()}catch(n){r(n.message||"Failed to update schedule")}finally{m(!1)}},R=()=>{x(null),i({cropId:"",farmId:"",irrigationDate:"",startTime:"06:00",duration:"",waterAmount:"",notes:""})};return D?e.jsx("div",{className:"flex items-center justify-center h-96",children:e.jsx("p",{className:"text-slate-400",children:"Loading schedules..."})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 -m-6 p-6",children:e.jsxs("div",{className:"space-y-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-cyan-500 rounded-xl shadow-lg p-6 text-white",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-5xl",children:"ðŸ’§"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold",children:"Irrigation Schedules"}),e.jsx("p",{className:"text-blue-100 mt-1",children:"Plan and track irrigation for your crops"})]})]}),e.jsx("button",{onClick:()=>{j(!p),x(null),i({cropId:"",farmId:"",irrigationDate:"",startTime:"06:00",duration:"",waterAmount:"",notes:""})},className:"bg-slate-800 text-cyan-400 px-6 py-3 rounded-lg font-semibold hover:bg-slate-700 transition-colors shadow-md border border-slate-600",children:p?"Cancel":"+ New Schedule"})]})}),w&&e.jsx("div",{className:"bg-red-900/30 border border-red-700 text-red-400 px-4 py-3 rounded-lg",children:w}),p&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Create New Schedule"}),e.jsxs("form",{onSubmit:E,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Select Farm ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"farmId",value:a.farmId,onChange:t,className:"form-input",required:!0,children:[e.jsx("option",{value:"",children:"-- Select a farm --"}),b.map(s=>e.jsx("option",{value:s.id,children:s.farmName},s.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Select Crop ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"cropId",value:a.cropId,onChange:t,className:"form-input",children:[e.jsx("option",{value:"",children:"-- Select a crop --"}),g.map(s=>e.jsx("option",{value:s.id,children:s.cropName},s.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Irrigation Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"irrigationDate",value:a.irrigationDate,onChange:t,className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Start Time ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"time",name:"startTime",value:a.startTime,onChange:t,className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Duration (minutes) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"duration",value:a.duration,onChange:t,className:"form-input",placeholder:"60",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Water Amount (liters) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"waterAmount",value:a.waterAmount,onChange:t,className:"form-input",placeholder:"10000",step:"0.1",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{name:"notes",value:a.notes,onChange:t,className:"form-input",placeholder:"Add any notes for this schedule",rows:"3"})]}),e.jsx("button",{type:"submit",disabled:o,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:o?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Creating..."]}):"Create Schedule"})]})]}),y&&e.jsxs("div",{className:"card",children:[e.jsx("h2",{className:"text-xl font-bold text-white mb-4",children:"Edit Irrigation Schedule"}),e.jsxs("form",{onSubmit:q,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Select Farm ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"farmId",value:a.farmId,onChange:t,className:"form-input",required:!0,children:[e.jsx("option",{value:"",children:"-- Select a farm --"}),b.map(s=>e.jsx("option",{value:s.id,children:s.farmName},s.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Select Crop ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("select",{name:"cropId",value:a.cropId,onChange:t,className:"form-input",children:[e.jsx("option",{value:"",children:"-- Select a crop --"}),g.map(s=>e.jsx("option",{value:s.id,children:s.cropName},s.id))]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Irrigation Date ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"date",name:"irrigationDate",value:a.irrigationDate,onChange:t,className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Start Time ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"time",name:"startTime",value:a.startTime,onChange:t,className:"form-input",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Duration (minutes) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"duration",value:a.duration,onChange:t,className:"form-input",placeholder:"60",required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"form-label",children:["Water Amount (liters) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"number",name:"waterAmount",value:a.waterAmount,onChange:t,className:"form-input",placeholder:"10000",step:"0.1",required:!0})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"form-label",children:"Notes"}),e.jsx("textarea",{name:"notes",value:a.notes,onChange:t,className:"form-input",placeholder:"Add any notes for this schedule",rows:"3"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("button",{type:"submit",disabled:o,className:"btn-primary disabled:opacity-50 disabled:cursor-not-allowed",children:o?e.jsxs("span",{className:"flex items-center justify-center",children:[e.jsxs("svg",{className:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Updating..."]}):"Update Schedule"}),e.jsx("button",{type:"button",onClick:R,className:"btn-secondary",children:"Cancel"})]})]})]}),N.length===0?e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl shadow-lg text-center py-12",children:[e.jsx("span",{className:"text-5xl mb-4 block",children:"ðŸŒ±"}),e.jsx("p",{className:"text-slate-400 text-lg",children:"No schedules yet. Create your first irrigation schedule!"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:N.map(s=>e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-xl shadow-lg hover:shadow-xl transition-all duration-300 overflow-hidden",children:[e.jsx("div",{className:"bg-gradient-to-r from-blue-500 to-cyan-500 p-4 text-white",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold",children:"Irrigation Schedule"}),e.jsxs("p",{className:"text-blue-100 text-sm",children:["ID: ",s.id]})]}),e.jsx("span",{className:"text-2xl",children:"ðŸ’§"})]})}),e.jsxs("div",{className:"p-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-400",children:"ðŸ“…"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 text-xs",children:"Date"}),e.jsx("p",{className:"font-semibold text-white",children:new Date(s.scheduleDate).toLocaleDateString()})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-400",children:"â±ï¸"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 text-xs",children:"Duration"}),e.jsxs("p",{className:"font-semibold text-white",children:[s.duration," minutes"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-blue-400",children:"ðŸ’¦"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-500 text-xs",children:"Water Amount"}),e.jsxs("p",{className:"font-semibold text-white",children:[s.waterAmount," liters"]})]})]})]}),e.jsxs("div",{className:"p-4 pt-0 flex space-x-2",children:[e.jsx("button",{onClick:()=>k(s),className:"flex-1 bg-blue-600 text-white py-2 rounded-lg font-medium hover:bg-blue-500 transition-colors text-sm",children:"Edit"}),e.jsx("button",{onClick:()=>F(s.id),className:"flex-1 bg-slate-700 text-slate-300 py-2 rounded-lg font-medium hover:bg-red-900/50 hover:text-red-400 transition-colors text-sm",children:"Delete"})]})]},s.id))})]})})}export{O as default};
//# sourceMappingURL=IrrigationSchedules-B7oDf4Yu.js.map
