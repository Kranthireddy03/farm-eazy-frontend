{"version":3,"file":"Orders-DirWc-jL.js","sources":["../../src/pages/Orders.jsx"],"sourcesContent":["import { useEffect, useState } from 'react'\r\nimport { useNavigate } from 'react-router-dom'\r\nimport apiClient from '../services/apiClient'\r\n\r\nfunction Orders() {\r\n    // Import dashboard stats refresh\r\n    const dashboardWindow = window;\r\n    const refreshDashboardStats = () => {\r\n      if (dashboardWindow.fetchStats) {\r\n        dashboardWindow.fetchStats();\r\n      }\r\n    };\r\n  const navigate = useNavigate()\r\n  const [orders, setOrders] = useState([])\r\n  const [loading, setLoading] = useState(true)\r\n  const [error, setError] = useState(null)\r\n\r\n  useEffect(() => {\r\n    const fetchOrders = async () => {\r\n      try {\r\n        const response = await apiClient.get('/orders')\r\n        const list = Array.isArray(response.data) ? response.data : []\r\n        setOrders(list)\r\n      } catch (err) {\r\n        setError('Could not load orders')\r\n      } finally {\r\n        setLoading(false)\r\n        refreshDashboardStats();\r\n      }\r\n    }\r\n\r\n    fetchOrders()\r\n  }, [])\r\n\r\n  const formatCurrency = (amount) => `â‚¹${Number(amount || 0).toFixed(2)}`\r\n\r\n  if (loading) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800\">\r\n        <p className=\"text-slate-300 text-lg\">Loading your orders...</p>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (error) {\r\n    return (\r\n      <div className=\"min-h-screen flex items-center justify-center bg-gradient-to-br from-slate-900 to-slate-800\">\r\n        <div className=\"bg-slate-800 rounded-lg shadow-lg p-8 text-center border border-slate-700\">\r\n          <p className=\"text-red-400 mb-4\">{error}</p>\r\n          <button\r\n            onClick={() => navigate('/buying')}\r\n            className=\"bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-lg transition\"\r\n          >\r\n            Back to shop\r\n          </button>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  if (orders.length === 0) {\r\n    return (\r\n      <div className=\"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 py-8 px-4\">\r\n        <div className=\"max-w-4xl mx-auto\">\r\n          <div className=\"bg-slate-800 rounded-lg shadow-lg p-8 text-center border border-slate-700\">\r\n            <div className=\"text-6xl mb-4\">ðŸ“¦</div>\r\n            <h1 className=\"text-3xl font-bold text-white mb-2\">My Orders</h1>\r\n            <p className=\"text-slate-400 mb-6\">Your order history will appear here.</p>\r\n            <button\r\n              onClick={() => navigate('/buying')}\r\n              className=\"bg-orange-500 hover:bg-orange-600 text-white font-bold py-3 px-8 rounded-lg transition\"\r\n            >\r\n              Start Shopping\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    )\r\n  }\r\n\r\n  return (\r\n    <div className=\"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 py-8 px-4\">\r\n      <div className=\"max-w-5xl mx-auto space-y-6\">\r\n        <div className=\"flex items-center justify-between\">\r\n          <div>\r\n            <p className=\"text-sm text-slate-400\">Order history</p>\r\n            <h1 className=\"text-3xl font-bold text-white\">My Orders</h1>\r\n          </div>\r\n          <button\r\n            onClick={() => navigate('/buying')}\r\n            className=\"bg-orange-500 hover:bg-orange-600 text-white font-bold py-2 px-4 rounded-lg transition\"\r\n          >\r\n            Continue shopping\r\n          </button>\r\n        </div>\r\n\r\n        <div className=\"space-y-4\">\r\n          {orders.map(order => (\r\n            <div key={order.id} className=\"bg-slate-800 rounded-lg shadow-lg p-6 border border-slate-700\">\r\n              <div className=\"flex flex-col md:flex-row md:items-center md:justify-between gap-4\">\r\n                <div>\r\n                  <p className=\"text-sm text-slate-400\">Order ID</p>\r\n                  <p className=\"text-lg font-semibold text-white\">#FZ{order.id}</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-sm text-slate-400\">Placed on</p>\r\n                  <p className=\"text-lg font-semibold text-white\">{order.createdAt?.split('T')[0] || 'â€”'}</p>\r\n                </div>\r\n                <div>\r\n                  <p className=\"text-sm text-slate-400\">Total</p>\r\n                  <p className=\"text-lg font-semibold text-orange-400\">{formatCurrency(order.finalAmount)}</p>\r\n                </div>\r\n                <div className=\"text-right\">\r\n                  <span className=\"px-3 py-1 rounded-full text-sm font-semibold bg-blue-900/50 text-blue-400\">\r\n                    {order.orderStatus || 'PENDING'}\r\n                  </span>\r\n                  <div className=\"text-xs text-slate-400 mt-1\">Payment: {order.paymentStatus}</div>\r\n                </div>\r\n              </div>\r\n\r\n              {order.items && order.items.length > 0 && (\r\n                <div className=\"mt-4 border-t border-slate-600 pt-4 text-sm text-slate-300\">\r\n                  {order.items.map(item => (\r\n                    <div key={`${order.id}-${item.productId}`} className=\"flex justify-between py-1 items-center\">\r\n                      <div>\r\n                        <span className=\"font-semibold text-white\">{item.productName}</span> Ã— {item.quantity}\r\n                        {item.discountedPrice !== undefined && item.discountedPrice < item.price ? (\r\n                          <>\r\n                            <span className=\"ml-2 text-orange-400 font-bold\">â‚¹{item.discountedPrice.toFixed(2)}</span>\r\n                            <span className=\"ml-2 line-through text-slate-500\">â‚¹{item.price.toFixed(2)}</span>\r\n                            <span className=\"ml-2 text-green-400 font-semibold\">Saved â‚¹{((item.price - item.discountedPrice) * item.quantity).toFixed(2)}</span>\r\n                          </>\r\n                        ) : (\r\n                          <span className=\"ml-2 text-orange-400 font-bold\">â‚¹{item.price.toFixed(2)}</span>\r\n                        )}\r\n                      </div>\r\n                      <span className=\"text-white\">{formatCurrency(item.totalPrice)}</span>\r\n                    </div>\r\n                  ))}\r\n                  {/* Order-level savings */}\r\n                  {order.items.some(item => item.discountedPrice !== undefined && item.discountedPrice < item.price) && (\r\n                    <div className=\"flex justify-end text-green-400 font-semibold mt-2\">\r\n                      <span>\r\n                        Total Discount Savings: â‚¹{\r\n                          order.items.reduce((sum, item) => {\r\n                            if (item.discountedPrice !== undefined && item.discountedPrice < item.price) {\r\n                              return sum + ((item.price - item.discountedPrice) * item.quantity);\r\n                            }\r\n                            return sum;\r\n                          }, 0).toFixed(2)\r\n                        }\r\n                      </span>\r\n                    </div>\r\n                  )}\r\n                </div>\r\n              )}\r\n            </div>\r\n          ))}\r\n        </div>\r\n      </div>\r\n    </div>\r\n  )\r\n}\r\n\r\nexport default Orders\r\n"],"names":["Orders","dashboardWindow","refreshDashboardStats","navigate","useNavigate","orders","setOrders","useState","loading","setLoading","error","setError","useEffect","response","apiClient","list","formatCurrency","amount","jsx","jsxs","order","item","Fragment","sum"],"mappings":"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"}