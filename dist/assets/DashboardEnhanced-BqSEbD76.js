import{u as J,i as q,f as K,r as a,h as r,j as e,T as Q,L as f}from"./index-BSllqeVN.js";function Z(){const n=J(),{toast:j,showToast:N,closeToast:L}=q(),{coins:E}=K(),[m,_]=a.useState(""),[h,P]=a.useState("name"),[C,u]=a.useState(null),[l,I]=a.useState({totalFarms:0,totalCrops:0,totalIrrigations:0,totalProducts:0,totalOrders:0,totalServices:0,activeAlerts:0}),[d,F]=a.useState([]),[g,k]=a.useState([]),[M,R]=a.useState(!0),[p,G]=a.useState("ALL"),[b,U]=a.useState(""),[S,w]=a.useState([]),V=[{value:"ALL",label:"All Activities",icon:"ðŸ“"},{value:"REGISTERED",label:"Account",icon:"âœï¸"},{value:"ORDER_PLACED",label:"Orders",icon:"ðŸ“¦"},{value:"ADDED_PRODUCT",label:"Products",icon:"âž•"},{value:"FARM_ADDED",label:"Farms",icon:"ðŸŒ¾"},{value:"CROP_ADDED",label:"Crops",icon:"ðŸŒ±"},{value:"COINS_EARNED",label:"Coins",icon:"ðŸª™"}];a.useEffect(()=>{H()},[]),a.useEffect(()=>{B()},[d,p,b]);const H=async()=>{try{R(!0);const[t,s,o,y,O,A]=await Promise.allSettled([r.get("/farms"),r.get("/crops"),r.get("/irrigation"),r.get("/products"),r.get("/services/listings"),r.get("/orders").catch(()=>({data:{totalOrders:0}}))]),T=await r.get("/activities");F(Array.isArray(T.data)?T.data:[]);const i={...l};if(t.status==="fulfilled"&&(i.totalFarms=Array.isArray(t.value.data)?t.value.data.length:0),s.status==="fulfilled"&&(i.totalCrops=Array.isArray(s.value.data)?s.value.data.length:0),o.status==="fulfilled"&&(i.totalIrrigations=Array.isArray(o.value.data)?o.value.data.length:0),y.status==="fulfilled"&&(i.totalProducts=Array.isArray(y.value.data)?y.value.data.length:0),O.status==="fulfilled"){const c=O.value.data;let v=null;try{v=JSON.parse(localStorage.getItem("user"))}catch{}let x=[];c.content&&Array.isArray(c.content)?x=c.content:Array.isArray(c)&&(x=c);let D=x;v&&v.id&&(D=x.filter($=>$.userId===v.id)),w(D),i.totalServices=D.length,x.length||(w([]),i.totalServices=0)}A.status==="fulfilled"&&(i.totalOrders=Array.isArray(A.value.data)?A.value.data.length:0),I(i)}catch(t){console.error("Error fetching stats:",t),N("Failed to load dashboard data","error")}finally{R(!1)}},Y=t=>{n(`/services/edit/${t}`)},z=async t=>{try{await r.delete(`/services/${t}`),w(s=>s.filter(o=>o.id!==t)),N("Service deleted successfully","success"),u(null)}catch{N("Failed to delete service","error"),u(null)}},B=()=>{let t=d;p!=="ALL"&&(t=t.filter(s=>s.activityType===p)),b&&(t=t.filter(s=>s.description.toLowerCase().includes(b.toLowerCase()))),k(t)},W=t=>({REGISTERED:"âœï¸",LOGGED_IN:"ðŸ”“",LOGGED_OUT:"ðŸ”’",ADDED_PRODUCT:"âž•",REMOVED_PRODUCT:"âž–",UPDATED_PRODUCT:"âœï¸",ADDED_TO_CART:"ðŸ›’",REMOVED_FROM_CART:"ðŸ—‘ï¸",ORDER_PLACED:"ðŸ“¦",ORDER_PAID:"ðŸ’³",ORDER_SHIPPED:"ðŸšš",ORDER_DELIVERED:"âœ…",ORDER_CANCELLED:"âŒ",COINS_EARNED:"ðŸª™",COINS_USED:"ðŸ’°",PASSWORD_CHANGED:"ðŸ”",PROFILE_UPDATED:"ðŸ‘¤",FARM_ADDED:"ðŸŒ¾",FARM_UPDATED:"ðŸ”„",FARM_DELETED:"âŒ",CROP_ADDED:"ðŸŒ±",CROP_UPDATED:"ðŸ”„",CROP_DELETED:"âŒ",IRRIGATION_ADDED:"ðŸ’§",IRRIGATION_UPDATED:"ðŸ”„",IRRIGATION_DELETED:"âŒ",PAYMENT_FAILED:"âš ï¸"})[t]||"ðŸ“";return M?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 py-8 px-4 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-400 mx-auto mb-4"}),e.jsx("p",{className:"text-slate-400",children:"Loading dashboard..."})]})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-900 to-slate-800 py-8 px-4",children:[j&&e.jsx(Q,{message:j.message,type:j.type,onClose:L}),e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-4xl font-bold text-white mb-2",children:"Welcome Back! ðŸ‘‹"}),e.jsx("p",{className:"text-slate-400",children:"Here's your farming dashboard overview"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow border-l-4 border-l-green-500",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"Active Farms"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:l.totalFarms}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:l.totalFarms===0?"âœš Add your first farm":"ðŸ“Š Manage farms"})]}),e.jsx("div",{className:"text-5xl",children:"ðŸŒ¾"})]}),e.jsx(f,{to:"/farms",className:"mt-4 inline-block px-4 py-2 bg-green-900/50 text-green-400 rounded-lg text-sm font-semibold hover:bg-green-900/70 transition",children:"View Farms â†’"})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow border-l-4 border-l-blue-500",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"Growing Crops"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:l.totalCrops}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:l.totalCrops===0?"âœš Plant your first crop":"ðŸŒ± Monitor growth"})]}),e.jsx("div",{className:"text-5xl",children:"ðŸŒ±"})]}),e.jsx(f,{to:"/crops",className:"mt-4 inline-block px-4 py-2 bg-blue-900/50 text-blue-400 rounded-lg text-sm font-semibold hover:bg-blue-900/70 transition",children:"View Crops â†’"})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow border-l-4 border-l-orange-500",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"Listed Products"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:l.totalProducts}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:l.totalProducts===0?"âœš Sell products":"ðŸ›ï¸ Manage sales"})]}),e.jsx("div",{className:"text-5xl",children:"ðŸ“¦"})]}),e.jsx(f,{to:"/selling",className:"mt-4 inline-block px-4 py-2 bg-orange-900/50 text-orange-400 rounded-lg text-sm font-semibold hover:bg-orange-900/70 transition",children:"Manage â†’"})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg shadow-lg p-6 hover:shadow-xl transition-shadow border-l-4 border-l-purple-500",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-slate-400 text-sm font-medium",children:"Orders Placed"}),e.jsx("p",{className:"text-3xl font-bold text-white mt-2",children:l.totalOrders}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:l.totalOrders===0?"âœš Start shopping":"ðŸ›’ View orders"})]}),e.jsx("div",{className:"text-5xl",children:"ðŸ›’"})]}),e.jsx("button",{onClick:()=>n("/cart"),className:"mt-4 inline-block px-4 py-2 bg-purple-900/50 text-purple-400 rounded-lg text-sm font-semibold hover:bg-purple-900/70 transition",children:"Go to Cart â†’"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-8",children:[e.jsx("div",{className:"bg-gradient-to-r from-yellow-400 to-yellow-500 rounded-lg shadow-lg p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-yellow-100 text-sm font-medium",children:"Available Coins"}),e.jsxs("p",{className:"text-4xl font-bold mt-2",children:[E?.totalCoins||0," ðŸª™"]}),e.jsxs("p",{className:"text-yellow-100 text-xs mt-2",children:["â‰ˆ â‚¹",E?.totalCoins||0," in value"]})]}),e.jsx("div",{className:"text-6xl opacity-50",children:"ðŸ’°"})]})}),e.jsx("div",{className:"bg-gradient-to-r from-blue-400 to-blue-500 rounded-lg shadow-lg p-6 text-white",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-blue-100 text-sm font-medium",children:"Irrigation Schedules"}),e.jsx("p",{className:"text-4xl font-bold mt-2",children:l.totalIrrigations}),e.jsx("p",{className:"text-blue-100 text-xs mt-2",children:l.totalIrrigations===0?"âœš Create schedule":"ðŸ’§ Active schedules"})]}),e.jsx("div",{className:"text-6xl opacity-50",children:"ðŸ’§"})]})}),e.jsxs("div",{className:"bg-gradient-to-r from-indigo-400 to-indigo-500 rounded-lg shadow-lg p-6 text-white",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-indigo-100 text-sm font-medium",children:"Service Listings"}),e.jsx("p",{className:"text-4xl font-bold mt-2",children:l.totalServices}),e.jsx("p",{className:"text-indigo-100 text-xs mt-2",children:l.totalServices===0?"âœš List services":"ðŸ”§ Active services"})]}),e.jsx("div",{className:"text-6xl opacity-50",children:"ðŸšœ"})]}),e.jsx(f,{to:"/irrigation-services",className:"mt-3 inline-block px-4 py-2 bg-indigo-600 text-white rounded-lg text-sm font-semibold hover:bg-indigo-500 transition",children:"View Services â†’"})]})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg shadow-lg p-6 mt-8",children:[e.jsxs("h2",{className:"text-2xl font-bold text-white mb-4 flex items-center",children:[e.jsx("span",{className:"mr-2",children:"ðŸšœ"})," My Service Listings"]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-4",children:[e.jsx("input",{type:"text",value:m,onChange:t=>_(t.target.value),placeholder:"Filter by name or description...",className:"px-3 py-2 bg-slate-700 border border-slate-600 text-white placeholder-slate-400 rounded-lg w-full md:w-1/2 focus:outline-none focus:ring-2 focus:ring-indigo-500"}),e.jsxs("select",{value:h,onChange:t=>P(t.target.value),className:"px-3 py-2 bg-slate-700 border border-slate-600 text-white rounded-lg w-full md:w-1/4 focus:outline-none focus:ring-2 focus:ring-indigo-500",children:[e.jsx("option",{value:"name",children:"Sort by Name"}),e.jsx("option",{value:"price",children:"Sort by Price"}),e.jsx("option",{value:"status",children:"Sort by Status"})]})]}),S.length===0?e.jsx("p",{className:"text-slate-500",children:"No service listings yet."}):e.jsx("ul",{children:S.filter(t=>!m||t.name&&t.name.toLowerCase().includes(m.toLowerCase())||t.description&&t.description.toLowerCase().includes(m.toLowerCase())).sort((t,s)=>h==="name"?(t.name||"").localeCompare(s.name||""):h==="price"?(t.price||0)-(s.price||0):h==="status"?(t.status||"").localeCompare(s.status||""):0).map(t=>e.jsxs("li",{className:"flex items-center justify-between border-b border-slate-700 py-3",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("span",{className:"text-2xl",children:"ðŸ”§"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-white",children:t.name}),t.description&&e.jsx("div",{className:"text-sm text-slate-400 mt-1",children:t.description}),t.price&&e.jsxs("div",{className:"text-sm text-green-400 mt-1",children:["â‚¹",t.price]}),t.status&&e.jsxs("div",{className:"text-xs text-indigo-400 mt-1",children:["Status: ",t.status]})]})]}),e.jsxs("div",{children:[e.jsx("button",{className:"bg-blue-500 text-white px-3 py-1 rounded mr-2",onClick:()=>Y(t.id),children:"Edit"}),e.jsx("button",{className:"bg-red-500 text-white px-3 py-1 rounded",onClick:()=>u(t.id),children:"Delete"})]})]},t.id))}),C&&e.jsxs("div",{className:"fixed inset-0 flex items-center justify-center z-50",children:[e.jsx("div",{className:"bg-black bg-opacity-50 absolute inset-0"}),e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg shadow-xl p-6 relative z-10 w-96",children:[e.jsx("h3",{className:"text-lg font-bold text-white mb-4",children:"Confirm Delete"}),e.jsx("p",{className:"text-slate-300 mb-6",children:"Are you sure you want to delete this service?"}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{className:"bg-slate-600 text-slate-200 px-4 py-2 rounded hover:bg-slate-500 transition",onClick:()=>u(null),children:"Cancel"}),e.jsx("button",{className:"bg-red-600 text-white px-4 py-2 rounded hover:bg-red-500 transition",onClick:()=>z(C),children:"Delete"})]})]})]})]}),e.jsxs("div",{className:"bg-slate-800 border border-slate-700 rounded-lg shadow-lg overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-indigo-600 to-indigo-700 px-6 py-4",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"ðŸ“Š Your Activity Feed"}),e.jsx("p",{className:"text-indigo-100 text-sm mt-1",children:"Track all your actions and interactions"})]}),e.jsx("div",{className:"px-6 py-4 border-b border-slate-700 bg-slate-700/50",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Activity Type"}),e.jsx("select",{value:p,onChange:t=>G(t.target.value),className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 text-white rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent",children:V.map(t=>e.jsxs("option",{value:t.value,children:[t.icon," ",t.label]},t.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-300 mb-2",children:"Search Activities"}),e.jsx("input",{type:"text",value:b,onChange:t=>U(t.target.value),placeholder:"Search description...",className:"w-full px-4 py-2 bg-slate-700 border border-slate-600 text-white placeholder-slate-400 rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-transparent"})]}),e.jsx("div",{className:"flex items-end",children:e.jsxs("div",{className:"px-4 py-2 bg-indigo-900/50 text-indigo-300 rounded-lg font-semibold",children:[g.length," result",g.length!==1?"s":""]})})]})}),e.jsx("div",{className:"divide-y divide-slate-700 max-h-96 overflow-y-auto",children:g.length===0?e.jsxs("div",{className:"px-6 py-12 text-center",children:[e.jsx("p",{className:"text-slate-400 text-lg",children:"ðŸ“­ No activities found"}),e.jsx("p",{className:"text-slate-500 text-sm mt-2",children:"Your activities will appear here"})]}):g.map(t=>e.jsx("div",{className:"px-6 py-4 hover:bg-slate-700/50 transition",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"text-2xl flex-shrink-0 pt-1",children:W(t.activityType)}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-white",children:t.description}),t.details&&e.jsx("p",{className:"text-xs text-slate-400 mt-1",children:t.details}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:t.timeAgo})]}),e.jsx("div",{className:"flex-shrink-0 ml-2",children:e.jsx("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-slate-700 text-slate-300",children:t.activityType.replace(/_/g," ")})})]})},t.id))}),d.length>0&&e.jsx("div",{className:"px-6 py-4 bg-slate-700/50 border-t border-slate-700",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4 text-center",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:d.filter(t=>t.activityType.includes("FARM")).length}),e.jsx("p",{className:"text-xs text-slate-400",children:"Farm Actions"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:d.filter(t=>t.activityType.includes("CROP")).length}),e.jsx("p",{className:"text-xs text-slate-400",children:"Crop Actions"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:d.filter(t=>t.activityType.includes("ORDER")).length}),e.jsx("p",{className:"text-xs text-slate-400",children:"Order Actions"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold text-white",children:d.filter(t=>t.activityType.includes("COIN")).length}),e.jsx("p",{className:"text-xs text-slate-400",children:"Coin Actions"})]})]})})]}),e.jsxs("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("button",{onClick:()=>n("/farms"),className:"bg-slate-800 border border-slate-700 rounded-lg shadow-md p-4 hover:shadow-lg hover:bg-slate-700 transition text-left border-l-4 border-l-green-500",children:[e.jsx("p",{className:"text-2xl",children:"ðŸŒ¾"}),e.jsx("p",{className:"font-semibold text-white mt-2",children:"Add Farm"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Create a new farm"})]}),e.jsxs("button",{onClick:()=>n("/crops"),className:"bg-slate-800 border border-slate-700 rounded-lg shadow-md p-4 hover:shadow-lg hover:bg-slate-700 transition text-left border-l-4 border-l-blue-500",children:[e.jsx("p",{className:"text-2xl",children:"ðŸŒ±"}),e.jsx("p",{className:"font-semibold text-white mt-2",children:"Plant Crop"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Add new crop"})]}),e.jsxs("button",{onClick:()=>n("/buying"),className:"bg-slate-800 border border-slate-700 rounded-lg shadow-md p-4 hover:shadow-lg hover:bg-slate-700 transition text-left border-l-4 border-l-orange-500",children:[e.jsx("p",{className:"text-2xl",children:"ðŸ›’"}),e.jsx("p",{className:"font-semibold text-white mt-2",children:"Shop"}),e.jsx("p",{className:"text-sm text-slate-400",children:"Browse marketplace"})]})]})]})]})}export{Z as default};
//# sourceMappingURL=DashboardEnhanced-BqSEbD76.js.map
