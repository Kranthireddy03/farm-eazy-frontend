import{r as a,j as e,A as k,u as D,L as O}from"./index-CfUSoOK0.js";function z({isOpen:f,onClose:b,email:l,phone:S,purpose:x,onVerified:y,onResend:j}){const[i,p]=a.useState(["","","","","",""]),[o,h]=a.useState(!1),[v,d]=a.useState(""),[g,u]=a.useState(""),[m,w]=a.useState(0),c=a.useRef([]);a.useEffect(()=>{f&&c.current[0]&&setTimeout(()=>c.current[0].focus(),100)},[f]),a.useEffect(()=>{if(m>0){const t=setTimeout(()=>w(m-1),1e3);return()=>clearTimeout(t)}},[m]),a.useEffect(()=>{f&&(p(["","","","","",""]),d(""),u(""))},[f]);const C=(t,s)=>{if(s&&!/^\d$/.test(s))return;const n=[...i];n[t]=s,p(n),d(""),s&&t<5&&c.current[t+1]?.focus()},N=(t,s)=>{s.key==="Backspace"&&!i[t]&&t>0&&c.current[t-1]?.focus()},E=t=>{t.preventDefault();const s=t.clipboardData.getData("text").trim();if(/^\d{6}$/.test(s)){const n=s.split("");p(n),c.current[5]?.focus()}},P=async()=>{const t=i.join("");if(t.length!==6){d("Please enter all 6 digits");return}h(!0),d("");try{(await k.verifyOtp(l,t,x)).verified?(u("OTP verified successfully!"),setTimeout(()=>y(),500)):d("Invalid OTP. Please try again.")}catch(s){d(s.message||"Failed to verify OTP. Please try again.")}finally{h(!1)}},r=async()=>{if(!(m>0)){h(!0),d("");try{await k.requestOtp(l,S,x),u("OTP resent successfully! Check your email."),w(60),p(["","","","","",""]),c.current[0]?.focus()}catch(t){d(t.message||"Failed to resend OTP. Please try again.")}finally{h(!1)}}};return f?e.jsxs("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4",children:[e.jsx("div",{className:"absolute inset-0 bg-black/60 backdrop-blur-sm",onClick:b}),e.jsx("div",{className:"relative w-full max-w-md transform transition-all animate-[slideUp_0.3s_ease-out]",children:e.jsxs("div",{className:"bg-gradient-to-br from-slate-900 via-slate-800 to-slate-900 rounded-3xl shadow-2xl border border-white/10 overflow-hidden",children:[e.jsxs("div",{className:"bg-gradient-to-r from-emerald-600 via-green-600 to-teal-600 p-6 text-center",children:[e.jsx("div",{className:"w-16 h-16 bg-white/20 rounded-2xl flex items-center justify-center mx-auto mb-4 animate-bounce",style:{animationDuration:"2s"},children:e.jsx("span",{className:"text-4xl",children:"ðŸ“§"})}),e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Verify Your Email"}),e.jsx("p",{className:"text-emerald-100 mt-2 text-sm",children:"We've sent a 6-digit code to"}),e.jsx("p",{className:"text-white font-semibold",children:l})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("div",{className:"flex justify-center gap-2 mb-6",children:i.map((t,s)=>e.jsx("input",{ref:n=>c.current[s]=n,type:"text",inputMode:"numeric",maxLength:1,value:t,onChange:n=>C(s,n.target.value),onKeyDown:n=>N(s,n),onPaste:s===0?E:void 0,className:`w-12 h-14 text-center text-2xl font-bold rounded-xl border-2 bg-white/5 text-white focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:border-transparent transition-all ${v?"border-red-400 bg-red-500/10":t?"border-emerald-400 bg-emerald-500/10":"border-white/20 hover:border-white/40"}`,disabled:o},s))}),v&&e.jsxs("div",{className:"bg-red-500/20 border border-red-400/30 text-red-200 px-4 py-3 rounded-xl mb-4 flex items-center gap-2 animate-shake",children:[e.jsx("span",{children:"âŒ"}),e.jsx("p",{className:"text-sm font-medium",children:v})]}),g&&e.jsxs("div",{className:"bg-emerald-500/20 border border-emerald-400/30 text-emerald-200 px-4 py-3 rounded-xl mb-4 flex items-center gap-2",children:[e.jsx("span",{children:"âœ…"}),e.jsx("p",{className:"text-sm font-medium",children:g})]}),e.jsx("button",{onClick:P,disabled:o||i.join("").length!==6,className:`w-full py-4 rounded-xl font-bold text-white transition-all transform flex items-center justify-center gap-2 ${o||i.join("").length!==6?"bg-gray-600 cursor-not-allowed":"bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 shadow-lg shadow-emerald-500/30 hover:scale-[1.02]"}`,children:o?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Verifying..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"âœ“"})," Verify OTP"]})}),e.jsx("div",{className:"text-center mt-6 pt-4 border-t border-white/10",children:e.jsxs("p",{className:"text-gray-400 text-sm",children:["Didn't receive the code?"," ",m>0?e.jsxs("span",{className:"text-gray-500",children:["Resend in ",e.jsxs("span",{className:"text-emerald-400 font-bold",children:[m,"s"]})]}):e.jsx("button",{onClick:r,disabled:o,className:"text-emerald-400 hover:text-emerald-300 font-semibold hover:underline disabled:text-gray-500",children:"Resend OTP"})]})}),e.jsx("button",{onClick:b,disabled:o,className:"w-full mt-4 py-3 text-gray-400 hover:text-white font-medium transition-colors rounded-xl hover:bg-white/5",children:"â† Back to Login"})]})]})}),e.jsx("style",{children:`
        @keyframes slideUp {
          from {
            opacity: 0;
            transform: translateY(20px);
          }
          to {
            opacity: 1;
            transform: translateY(0);
          }
        }
        @keyframes shake {
          0%, 100% { transform: translateX(0); }
          25% { transform: translateX(-5px); }
          75% { transform: translateX(5px); }
        }
        .animate-shake {
          animation: shake 0.3s ease-in-out;
        }
      `})]}):null}function I({onLoginSuccess:f}){const b=D();a.useEffect(()=>{sessionStorage.getItem("logout_flag")&&(localStorage.removeItem("farmEazy_token"),localStorage.removeItem("farmEazy_email"),localStorage.removeItem("farmEazy_userId"),localStorage.removeItem("farmEazy_username"),localStorage.removeItem("farmEazy_fullName"),sessionStorage.removeItem("logout_flag"))},[]);const[l,S]=a.useState({email:"",password:""}),[x,y]=a.useState({}),[j,i]=a.useState(""),[p,o]=a.useState(!1),[h,v]=a.useState(!1),[d,g]=a.useState(!1),[u,m]=a.useState(null),[w,c]=a.useState(""),C=()=>{const r={};return l.email?/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(l.email)||(r.email="Please enter a valid email"):r.email="Email is required",l.password?l.password.length<6&&(r.password="Password must be at least 6 characters"):r.password="Password is required",y(r),Object.keys(r).length===0},N=r=>{const{name:t,value:s}=r.target;S(n=>({...n,[t]:s})),x[t]&&y(n=>({...n,[t]:""}))},E=async r=>{if(r.preventDefault(),i(""),c(""),!!C()){o(!0);try{const t=await k.requestOtp(l.email,"0000000000","LOGIN");m({email:l.email,password:l.password}),c(t.message||"OTP sent to your email!"),g(!0)}catch(t){const s=t.message||"";s.includes("not found")||s.includes("Invalid credentials")?i("Account not found! Please register first."):i(s||"Failed to send OTP. Please try again.")}finally{o(!1)}}},P=async()=>{if(u){o(!0);try{await k.login(u.email,u.password),g(!1),f(),localStorage.getItem("firstLogin")!=="done"?(localStorage.setItem("firstLogin","done"),b("/",{state:{welcome:!0}})):b("/",{state:{welcomeBack:!0}})}catch(r){i(r.message?.includes("password")?"Incorrect password. Please try again.":r.message||"Login failed. Please try again."),g(!1)}finally{o(!1)}}};return e.jsxs("div",{className:"min-h-screen relative overflow-hidden flex items-center justify-center px-4 py-8",children:[e.jsxs("div",{className:"absolute inset-0 bg-gradient-to-br from-emerald-900 via-green-800 to-teal-900",children:[e.jsxs("div",{className:"absolute inset-0 opacity-30",children:[e.jsx("div",{className:"absolute top-0 -left-4 w-72 h-72 bg-yellow-400 rounded-full mix-blend-multiply filter blur-xl animate-pulse"}),e.jsx("div",{className:"absolute top-0 -right-4 w-72 h-72 bg-emerald-400 rounded-full mix-blend-multiply filter blur-xl animate-pulse",style:{animationDelay:"2s"}}),e.jsx("div",{className:"absolute -bottom-8 left-20 w-72 h-72 bg-green-300 rounded-full mix-blend-multiply filter blur-xl animate-pulse",style:{animationDelay:"4s"}})]}),e.jsx("div",{className:"absolute inset-0 opacity-5",style:{backgroundImage:`url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.4'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E")`}})]}),e.jsxs("div",{className:"absolute inset-0 overflow-hidden pointer-events-none",children:[e.jsx("div",{className:"absolute top-20 left-10 text-6xl opacity-20 animate-bounce",style:{animationDuration:"3s"},children:"ðŸŒ¾"}),e.jsx("div",{className:"absolute top-40 right-20 text-5xl opacity-20 animate-bounce",style:{animationDuration:"4s",animationDelay:"1s"},children:"ðŸŒ»"}),e.jsx("div",{className:"absolute bottom-32 left-1/4 text-4xl opacity-20 animate-bounce",style:{animationDuration:"5s",animationDelay:"2s"},children:"ðŸŒ±"}),e.jsx("div",{className:"absolute bottom-20 right-1/3 text-5xl opacity-20 animate-bounce",style:{animationDuration:"3.5s"},children:"ðŸšœ"})]}),e.jsxs("div",{className:"relative z-10 w-full max-w-md",children:[e.jsxs("div",{className:"backdrop-blur-xl bg-white/10 rounded-3xl shadow-2xl border border-white/20 p-8 transform transition-all duration-500 hover:scale-[1.02]",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsxs("div",{className:"relative inline-block",children:[e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-yellow-400 to-orange-500 rounded-2xl rotate-3 absolute -top-1 -left-1 opacity-50"}),e.jsx("div",{className:"w-20 h-20 bg-gradient-to-br from-emerald-400 to-green-600 rounded-2xl flex items-center justify-center relative shadow-lg",children:e.jsx("span",{className:"text-4xl",children:"ðŸŒ¾"})})]}),e.jsx("h1",{className:"text-4xl font-extrabold text-white mt-6 tracking-tight",children:"FarmEazy"}),e.jsx("p",{className:"text-emerald-200 mt-2 font-medium",children:"Welcome back, farmer!"})]}),e.jsxs("form",{onSubmit:E,className:"space-y-5",children:[j&&e.jsxs("div",{className:"bg-red-500/20 backdrop-blur-sm border border-red-400/30 text-red-100 px-4 py-3 rounded-xl flex items-start gap-3",children:[e.jsx("span",{className:"text-xl",children:"âš ï¸"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:j}),j.includes("not found")&&e.jsx(O,{to:"/register",className:"text-red-200 underline text-sm mt-1 inline-block hover:text-white",children:"Create an account â†’"})]})]}),w&&e.jsxs("div",{className:"bg-emerald-500/20 backdrop-blur-sm border border-emerald-400/30 text-emerald-100 px-4 py-3 rounded-xl flex items-center gap-3",children:[e.jsx("span",{className:"text-xl",children:"âœ…"}),e.jsx("p",{className:"font-medium",children:w})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-white/90 text-sm font-semibold flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ“§"})," Email Address"]}),e.jsx("input",{type:"email",name:"email",value:l.email,onChange:N,className:"w-full px-4 py-3.5 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:border-transparent transition-all duration-300 backdrop-blur-sm",placeholder:"farmer@example.com"}),x.email&&e.jsxs("p",{className:"text-red-300 text-sm flex items-center gap-1",children:[e.jsx("span",{children:"âŒ"})," ",x.email]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("label",{className:"text-white/90 text-sm font-semibold flex items-center gap-2",children:[e.jsx("span",{children:"ðŸ”"})," Password"]}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:h?"text":"password",name:"password",value:l.password,onChange:N,className:"w-full px-4 py-3.5 bg-white/10 border border-white/20 rounded-xl text-white placeholder-white/40 focus:outline-none focus:ring-2 focus:ring-emerald-400 focus:border-transparent transition-all duration-300 backdrop-blur-sm pr-12",placeholder:"â€¢â€¢â€¢â€¢â€¢â€¢â€¢â€¢"}),e.jsx("button",{type:"button",onClick:()=>v(!h),className:"absolute right-3 top-1/2 -translate-y-1/2 text-white/60 hover:text-white transition-colors",children:h?"ðŸ‘ï¸":"ðŸ‘ï¸â€ðŸ—¨ï¸"})]}),x.password&&e.jsxs("p",{className:"text-red-300 text-sm flex items-center gap-1",children:[e.jsx("span",{children:"âŒ"})," ",x.password]})]}),e.jsx("div",{className:"text-right",children:e.jsx(O,{to:"/forgot-password",className:"text-emerald-300 hover:text-white text-sm font-medium transition-colors",children:"Forgot password? â†’"})}),e.jsx("button",{type:"submit",disabled:p,className:"w-full py-4 bg-gradient-to-r from-emerald-500 to-green-600 hover:from-emerald-600 hover:to-green-700 text-white font-bold rounded-xl shadow-lg shadow-emerald-500/30 transform transition-all duration-300 hover:scale-[1.02] hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed disabled:transform-none flex items-center justify-center gap-2",children:p?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",fill:"none"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Sending OTP..."]}):e.jsxs(e.Fragment,{children:[e.jsx("span",{children:"ðŸ”‘"})," Login with OTP"]})})]}),e.jsxs("div",{className:"flex items-center gap-4 my-6",children:[e.jsx("div",{className:"flex-1 h-px bg-white/20"}),e.jsx("span",{className:"text-white/40 text-sm",children:"or"}),e.jsx("div",{className:"flex-1 h-px bg-white/20"})]}),e.jsx("div",{className:"text-center",children:e.jsxs("p",{className:"text-white/70",children:["New to FarmEazy?"," ",e.jsx(O,{to:"/register",className:"text-yellow-400 hover:text-yellow-300 font-bold transition-colors",children:"Join the farm! ðŸŒ±"})]})})]}),e.jsx("div",{className:"text-center mt-6 text-white/40 text-sm",children:e.jsx("p",{children:"ðŸŒ¾ Growing success together ðŸŒ¾"})})]}),e.jsx(z,{isOpen:d,onClose:()=>{g(!1),m(null)},email:u?.email||l.email,phone:"0000000000",purpose:"LOGIN",onVerified:P})]})}export{I as default};
//# sourceMappingURL=Login-DZ839EjP.js.map
